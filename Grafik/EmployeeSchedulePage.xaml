<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Grafik.EmployeeSchedulePage">

    <AbsoluteLayout>
        <!-- ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚ -->
        <Grid Padding="10" RowDefinitions="Auto,*" 
              AbsoluteLayout.LayoutBounds="0,0,1,1"
              AbsoluteLayout.LayoutFlags="All">
            <!-- Ð’ÐµÑ€Ñ…Ð½ÑÑ Ð¿Ð°Ð½ÐµÐ»ÑŒ -->
            <Grid ColumnDefinitions="*,Auto" Row="0" VerticalOptions="Center" ColumnSpacing="10">
                <Label x:Name="EmployeeNameLabel" FontSize="24"
                       VerticalOptions="Center"
                       HorizontalOptions="Start" />

                <StackLayout Orientation="Horizontal" Spacing="10" Grid.Column="1"
                             VerticalOptions="Center" HorizontalOptions="End">
                    <Label Text="Ð¡Ð¿Ð¸ÑÐ¾Ðº" VerticalOptions="Center"/>
                    <Switch x:Name="ViewSwitch" VerticalOptions="Center" />
                    <Label Text="Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð°" VerticalOptions="Center"/>
                </StackLayout>
            </Grid>

            <!-- ÐšÐ¾Ð½Ñ‚ÐµÐ½Ñ‚ -->
            <Grid Row="1">
                <!-- Ð ÐµÐ¶Ð¸Ð¼ ÑÐ¿Ð¸ÑÐ¾Ðº -->
                <ScrollView x:Name="ListContainer" IsVisible="True" Opacity="1">
                    <CollectionView x:Name="ScheduleListView">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Frame Padding="10"
                                       Margin="5"
                                       HasShadow="True"
                                       BorderColor="{Binding BorderColor}">
                                    <StackLayout>
                                        <Label Text="{Binding Date, StringFormat='{0:D}  ({0:ddd})'}"
                                               FontAttributes="Bold"/>
                                        <Label Text="{Binding Worktime}" FontAttributes="Bold"/>
                                        <Label Text="{Binding Shift}" />
                                        <Label Text="{Binding Employees}" />
                                        <Label Text="{Binding DisplayOtherEmployees}"
                                               FontSize="12"
                                               TextColor="Gray" />
                                        <Label Text="{Binding SecondLinePartner}"
                                               FontAttributes="Italic"
                                               TextColor="Green">
                                            <Label.Triggers>
                                                <DataTrigger TargetType="Label"
                                                             Binding="{Binding SecondLinePartner}"
                                                             Value="{x:Null}">
                                                    <Setter Property="IsVisible" Value="False"/>
                                                </DataTrigger>
                                                <DataTrigger TargetType="Label"
                                                             Binding="{Binding SecondLinePartner}"
                                                             Value="">
                                                    <Setter Property="IsVisible" Value="False"/>
                                                </DataTrigger>
                                            </Label.Triggers>
                                        </Label>
                                    </StackLayout>
                                </Frame>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </ScrollView>

                <!-- Ð ÐµÐ¶Ð¸Ð¼ ÐºÐ°Ð»ÐµÐ½Ð´Ð°Ñ€ÑŒ -->
                <ScrollView x:Name="CalendarContainer" IsVisible="False" Opacity="0">
                    <StackLayout Spacing="0">
                        <!-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº Ñ Ð´Ð½ÑÐ¼Ð¸ Ð½ÐµÐ´ÐµÐ»Ð¸ -->
                        <Grid ColumnDefinitions="*,*,*,*,*,*,*" RowDefinitions="40">
                            <Label Text="ÐŸÐ½" FontAttributes="Bold" HorizontalOptions="Center" VerticalOptions="Center"/>
                            <Label Text="Ð’Ñ‚" FontAttributes="Bold" HorizontalOptions="Center" VerticalOptions="Center" Grid.Column="1"/>
                            <Label Text="Ð¡Ñ€" FontAttributes="Bold" HorizontalOptions="Center" VerticalOptions="Center" Grid.Column="2"/>
                            <Label Text="Ð§Ñ‚" FontAttributes="Bold" HorizontalOptions="Center" VerticalOptions="Center" Grid.Column="3"/>
                            <Label Text="ÐŸÑ‚" FontAttributes="Bold" HorizontalOptions="Center" VerticalOptions="Center" Grid.Column="4"/>
                            <Label Text="Ð¡Ð±" FontAttributes="Bold" HorizontalOptions="Center" VerticalOptions="Center" Grid.Column="5"/>
                            <Label Text="Ð’Ñ" FontAttributes="Bold" HorizontalOptions="Center" VerticalOptions="Center" Grid.Column="6"/>
                        </Grid>

                        <!-- ÐšÐ°Ð»ÐµÐ½Ð´Ð°Ñ€ÑŒ -->
                        <CollectionView x:Name="CalendarView" SelectionMode="None">
                            <CollectionView.ItemsLayout>
                                <GridItemsLayout Orientation="Vertical" Span="7"/>
                            </CollectionView.ItemsLayout>
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Frame Padding="5" Margin="2"
                                           BackgroundColor="{Binding TileColor}"
                                           BorderColor="{Binding BorderColor}"
                                           CornerRadius="8" HasShadow="True"
                                           IsVisible="{Binding IsVisibleDay}">
                                        <Frame.GestureRecognizers>
                                            <TapGestureRecognizer Tapped="OnCalendarItemTapped" 
                                                                 CommandParameter="{Binding .}"/>
                                        </Frame.GestureRecognizers>
                                        <StackLayout>
                                            <Label Text="{Binding Date, StringFormat='{0:dd}'}"
                                                   HorizontalOptions="Center"
                                                   FontSize="18"
                                                   FontAttributes="Bold"/>
                                            <Label Text="{Binding Shift}" FontSize="10"
                                                   HorizontalOptions="Center"/>
                                        </StackLayout>
                                    </Frame>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </StackLayout>
                </ScrollView>
            </Grid>
        </Grid>

        <!-- ÐšÐ½Ð¾Ð¿ÐºÐ° Ñ‡Ð°Ñ‚Ð° (ÑÐ¿Ñ€Ð°Ð²Ð° ÑÐ½Ð¸Ð·Ñƒ Ñ Ð¾Ñ‚ÑÑ‚ÑƒÐ¿Ð¾Ð¼) -->
        <Button x:Name="ChatButton"
                Text="ðŸ’¬"
                FontSize="16"
                WidthRequest="50"
                HeightRequest="50"
                CornerRadius="25"
                BackgroundColor="#4CAF50"
                TextColor="White"
                Clicked="GoToChat"
                Margin="0,0,10,10"
                AbsoluteLayout.LayoutBounds="1,1,50,50"
                AbsoluteLayout.LayoutFlags="PositionProportional" />
    </AbsoluteLayout>
</ContentPage>