<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Class="Grafik.BugReportPage"
             Title="Ð‘Ð°Ð³-Ñ€ÐµÐ¿Ð¾Ñ€Ñ‚Ñ‹ Ð¸ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ">

    <Grid RowDefinitions="*,Auto" Padding="0">

        <!-- Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð±Ð°Ð³-Ñ€ÐµÐ¿Ð¾Ñ€Ñ‚Ð¾Ð² -->
        <CollectionView x:Name="ReportsCollectionView"
                        Grid.Row="0"
                        SelectionMode="None"
                        Margin="0,0,0,0">
            <CollectionView.EmptyView>
                <StackLayout VerticalOptions="Center" HorizontalOptions="Center" Padding="40">
                    <Label Text="ðŸ“‹" FontSize="48" HorizontalOptions="Center"/>
                    <Label Text="ÐÐµÑ‚ Ð¾Ð±Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ð¹" FontSize="16" TextColor="Gray" HorizontalOptions="Center"/>
                    <Label Text="ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ + Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ" FontSize="13" TextColor="#999" HorizontalOptions="Center"/>
                </StackLayout>
            </CollectionView.EmptyView>
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Border Stroke="{Binding StatusColor}"
                            StrokeThickness="1"
                            StrokeShape="RoundRectangle 8"
                            Padding="12"
                            Margin="10,6"
                            BackgroundColor="{Binding CardBackgroundColor}">
                        <StackLayout Spacing="6">

                            <!-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº: ÑÑ‚Ð°Ñ‚ÑƒÑ + Ñ‚Ð¸Ð¿ -->
                            <Grid ColumnDefinitions="Auto,*,Auto">
                                <Label Grid.Column="0"
                                       Text="{Binding StatusDisplay}"
                                       FontSize="11"
                                       TextColor="{Binding StatusColor}"
                                       FontAttributes="Bold"/>
                                <Label Grid.Column="2"
                                       Text="{Binding TypeDisplay}"
                                       FontSize="11"
                                       TextColor="Gray"/>
                            </Grid>

                            <!-- Ð”Ð°Ñ‚Ð° -->
                            <Label Text="{Binding TimestampDisplay, StringFormat='Ð”Ð°Ñ‚Ð°: {0}'}"
                                   FontSize="11"
                                   TextColor="Gray"/>

                            <!-- Ð¢ÐµÐ¼Ð° Ð¸ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ -->
                            <Border BackgroundColor="#FFCDD2"
                                    StrokeThickness="0"
                                    StrokeShape="RoundRectangle 6"
                                    Padding="10">
                                <StackLayout Spacing="2">
                                    <Label Text="{Binding Title}"
                                           FontSize="14"
                                           FontAttributes="Bold"
                                           TextColor="#333"/>
                                    <Label Text="{Binding Steps}"
                                           FontSize="13"
                                           TextColor="#555"
                                           LineBreakMode="WordWrap"/>
                                </StackLayout>
                            </Border>

                            <!-- ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÐµÐ»ÑŒ -->
                            <Label Text="{Binding Sender, StringFormat='ÐÐ²Ñ‚Ð¾Ñ€: {0}'}"
                                   FontSize="11"
                                   TextColor="Gray"
                                   Margin="0,2,0,0"/>

                            <!-- ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ° (Ð²Ð¸Ð´ÐµÐ½ Ð²ÑÐµÐ¼, ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ) -->
                            <Border BackgroundColor="#E3F2FD"
                                    StrokeThickness="0"
                                    StrokeShape="RoundRectangle 6"
                                    Padding="10"
                                    IsVisible="{Binding HasDevComment}">
                                <StackLayout Spacing="2">
                                    <Label Text="ðŸ’¬ ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ°"
                                           FontSize="11"
                                           TextColor="#1565C0"
                                           FontAttributes="Bold"/>
                                    <Label Text="{Binding DevComment}"
                                           FontSize="13"
                                           TextColor="#333"
                                           LineBreakMode="WordWrap"/>
                                </StackLayout>
                            </Border>

                            <!-- ÐŸÐ°Ð½ÐµÐ»ÑŒ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ° (Ð²Ð¸Ð´Ð½Ð° Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¡Ð°Ð»ÑŒÐ½Ð¸ÐºÐ¾Ð² Ð¡Ñ‚ÐµÐ¿Ð°Ð½) -->
                            <Border BackgroundColor="#FFFDE7"
                                    Stroke="#FFC107"
                                    StrokeThickness="1"
                                    StrokeShape="RoundRectangle 6"
                                    Padding="10"
                                    IsVisible="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.IsDev}">
                                <StackLayout Spacing="8">
                                    <Label Text="ðŸ›  ÐŸÐ°Ð½ÐµÐ»ÑŒ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ°"
                                           FontSize="11"
                                           TextColor="#F57F17"
                                           FontAttributes="Bold"/>

                                    <!-- Ð’Ñ‹Ð±Ð¾Ñ€ ÑÑ‚Ð°Ñ‚ÑƒÑÐ° -->
                                    <Label Text="Ð¡Ñ‚Ð°Ñ‚ÑƒÑ:" FontSize="11" TextColor="#333"/>
                                    <Border Stroke="#BDBDBD"
                                            StrokeThickness="1"
                                            StrokeShape="RoundRectangle 4"
                                            BackgroundColor="White"
                                            Padding="4,0">
                                        <Picker SelectedIndex="{Binding StatusIndex}"
                                                ItemsSource="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.StatusOptions}"
                                                FontSize="13"
                                                TextColor="#333"
                                                TitleColor="#999"/>
                                    </Border>

                                    <!-- ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹ -->
                                    <Label Text="ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹:" FontSize="11" TextColor="#333"/>
                                    <Border Stroke="#BDBDBD"
                                            StrokeThickness="1"
                                            StrokeShape="RoundRectangle 4"
                                            BackgroundColor="White"
                                            Padding="4">
                                        <Editor Placeholder="ÐžÐ±Ð¾ÑÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ, Ð¿Ð¾ÑÑÐ½ÐµÐ½Ð¸Ðµ..."
                                                PlaceholderColor="#999"
                                                Text="{Binding DevComment}"
                                                TextColor="#333"
                                                FontSize="13"
                                                HeightRequest="60"
                                                AutoSize="TextChanges"/>
                                    </Border>

                                    <!-- ÐžÐ´Ð½Ð° ÐºÐ½Ð¾Ð¿ÐºÐ° â€” Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ Ð²ÑÑ‘ -->
                                    <Button Text="ðŸ’¾ Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ"
                                            FontSize="12"
                                            HeightRequest="36"
                                            Padding="8,0"
                                            BackgroundColor="#FF8F00"
                                            TextColor="White"
                                            CornerRadius="4"
                                            CommandParameter="{Binding .}"
                                            Clicked="OnSaveDevResponseClicked"/>
                                </StackLayout>
                            </Border>

                        </StackLayout>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <!-- ÐŸÐ°Ð½ÐµÐ»ÑŒ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð¾Ð±Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ñ -->
        <Border x:Name="NewReportPanel"
                Grid.Row="1"
                IsVisible="False"
                Stroke="#CCCCCC"
                StrokeThickness="1"
                StrokeShape="RoundRectangle 12,12,0,0"
                BackgroundColor="{AppThemeBinding Light=White, Dark=#1E1E1E}"
                Padding="14">
            <StackLayout Spacing="10">

                <Label Text="ÐÐ¾Ð²Ð¾Ðµ Ð¾Ð±Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ðµ"
                       FontSize="16"
                       FontAttributes="Bold"
                       HorizontalOptions="Center"/>

                <!-- Ð¢Ð¸Ð¿ -->
                <Label Text="Ð¢Ð¸Ð¿:" FontSize="12"/>
                <Picker x:Name="TypePicker"
                        SelectedIndex="0"/>

                <!-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº -->
                <Label Text="Ð¢ÐµÐ¼Ð°:" FontSize="12"/>
                <Entry x:Name="TitleEntry"
                       Placeholder="ÐšÑ€Ð°Ñ‚ÐºÐ¾Ðµ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ / Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ"
                       FontSize="14"/>

                <!-- Ð¨Ð°Ð³Ð¸ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ -->
                <Label Text="ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ / ÐšÐ°Ðº Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÑÑ‚Ð¸:" FontSize="12"/>
                <Editor x:Name="StepsEditor"
                        Placeholder="ÐŸÐ¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹ Ð´Ð»Ñ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Ð¸Ð»Ð¸ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ"
                        HeightRequest="100"
                        FontSize="13"
                        AutoSize="TextChanges"/>

                <!-- ÐšÐ½Ð¾Ð¿ÐºÐ¸ -->
                <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                    <Button Grid.Column="0"
                            Text="ÐžÑ‚Ð¼ÐµÐ½Ð°"
                            Clicked="OnCancelClicked"
                            BackgroundColor="#9E9E9E"
                            TextColor="White"
                            CornerRadius="6"/>
                    <Button Grid.Column="1"
                            Text="ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ"
                            Clicked="OnSubmitClicked"
                            BackgroundColor="#F44336"
                            TextColor="White"
                            CornerRadius="6"/>
                </Grid>

            </StackLayout>
        </Border>

        <!-- ÐšÐ½Ð¾Ð¿ÐºÐ° Â«+Â» Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð¾Ð±Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ñ -->
        <Button x:Name="AddButton"
                Grid.Row="1"
                Text="ï¼‹ ÐÐ¾Ð²Ð¾Ðµ Ð¾Ð±Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ðµ"
                Clicked="OnAddClicked"
                BackgroundColor="#F44336"
                TextColor="White"
                FontSize="15"
                FontAttributes="Bold"
                Margin="10"
                CornerRadius="8"
                Padding="14"/>

    </Grid>

</ContentPage>